/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
'use strict';
const path = require("path");
const loaderUtils = require('loader-utils');
const fs = require("fs");
module.exports = function(content) {
  var context = this.rootContext || this.options && this.options.context;
  var url = loaderUtils.interpolateName(this, "[hash].[ext]", {
    context,
    content,
    regExp: undefined
  });

  this.emitFile(url, content);

  var publicPath = `__webpack_public_path__ + ${JSON.stringify(url)}`;
  var absPath = path.join("build", url);
  return `try {
  global.process.dlopen(module, ${process.cwd() + JSON.stringify(absPath)});
} catch(e) {
  throw new Error('Cannot open ' + ${publicPath} + ': ' + e);
};`
}
module.exports.raw = true;